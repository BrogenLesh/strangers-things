{"ast":null,"code":"import _regeneratorRuntime from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Link,useHistory}from\"react-router-dom\";import{fetchPosts,submitPost,deletePost}from\"./utility\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Posts=function Posts(_ref){var user=_ref.user,token=_ref.token,posts=_ref.posts,setPosts=_ref.setPosts,featuredPost=_ref.featuredPost,setFeaturedPost=_ref.setFeaturedPost;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),search=_useState2[0],setSearch=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),location=_useState6[0],setLocation=_useState6[1];var history=useHistory();useEffect(function(){return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=setPosts;_context.next=3;return fetchPosts(token);case 3:_context.t1=_context.sent;return _context.abrupt(\"return\",(0,_context.t0)(_context.t1));case 5:case\"end\":return _context.stop();}}},_callee);}))();},[]);var searchMatches=function searchMatches(post){return\"\".concat(post.location,\" \").concat(post.description).toLowerCase().includes(search.toLowerCase());};var handlePostClick=function handlePostClick(e,post){// check if user's logged in, if not then ignore\nif(user&&token){setFeaturedPost(post);history.push(\"/posts/\".concat(post.id));}else{alert(\"not logged in\");}};var handleSubmitPost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event){var newPosts;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();// Send the needed data to the endpoint\n_context2.next=3;return submitPost(token,location,description);case 3:newPosts=_context2.sent;// Do some stuff with the data that comes back\nsetPosts(newPosts);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function handleSubmitPost(_x){return _ref3.apply(this,arguments);};}();var handleDeletePost=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e,postId){var isDeleted,remainingPosts;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.stopPropagation();if(!window.confirm(\"Are you sure?\")){_context3.next=6;break;}_context3.next=4;return deletePost(token,postId);case 4:isDeleted=_context3.sent;// update my vacations state\n// Update the vacations state by removing the vacation i just deleted\nif(isDeleted){remainingPosts=posts.filter(function(vc){return vc.id!=postId;});setPosts(remainingPosts);}case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function handleDeletePost(_x2,_x3){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Posts\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setSearch(e.target.value);},type:\"text\",name:\"search\",placeholder:\"search\"}),user&&token&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitPost,children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setLocation(e.target.value);},type:\"text\",name:\"location\",placeholder:\"location\",value:location}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setDescription(e.target.value);},type:\"text\",name:\"description\",placeholder:\"description\",value:description}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit Posts\"})]}),/*#__PURE__*/_jsx(\"section\",{children:posts.filter(function(post){return searchMatches(post);}).map(function(post){return/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(e){handlePostClick(e,post);},className:\"vacation-body\",children:[/*#__PURE__*/_jsx(\"h3\",{children:post.location}),/*#__PURE__*/_jsx(\"p\",{children:post.description}),user&&token&&post.guestId==user.id&&/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleDeletePost(e,post.id);},children:\"Delete post\"})]},post.id);})})]});};export default Posts;/// fix vactions body css in line 83","map":{"version":3,"names":["React","useEffect","useState","Link","useHistory","fetchPosts","submitPost","deletePost","Posts","user","token","posts","setPosts","featuredPost","setFeaturedPost","search","setSearch","description","setDescription","location","setLocation","history","searchMatches","post","toLowerCase","includes","handlePostClick","e","push","id","alert","handleSubmitPost","event","preventDefault","newPosts","handleDeletePost","postId","stopPropagation","window","confirm","isDeleted","remainingPosts","filter","vc","target","value","map","guestId"],"sources":["D:/vscode project/Course Work/strangers-things/src/components/posts.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { fetchPosts, submitPost, deletePost } from \"./utility\";\r\n\r\nconst Posts = ({\r\n    user,\r\n    token,\r\n    posts,\r\n    setPosts,\r\n    featuredPost,\r\n    setFeaturedPost,\r\n}) => {\r\n    const [search, setSearch] = useState(\"\");\r\n    const [description, setDescription] = useState(\"\");\r\n    const [location, setLocation] = useState(\"\");\r\n\r\n    const history = useHistory();\r\n\r\n    useEffect(() => (async () => setPosts(await fetchPosts(token)))(), []);\r\n\r\n    const searchMatches = (post) => {\r\n        return `${post.location} ${post.description}`\r\n            .toLowerCase()\r\n            .includes(search.toLowerCase());\r\n    };\r\n\r\n    const handlePostClick = (e, post) => {\r\n        // check if user's logged in, if not then ignore\r\n        if (user && token) {\r\n            setFeaturedPost(post);\r\n            history.push(`/posts/${post.id}`);\r\n        } else {\r\n            alert(\"not logged in\");\r\n        }\r\n    };\r\n\r\n    const handleSubmitPost = async (event) => {\r\n        event.preventDefault();\r\n        // Send the needed data to the endpoint\r\n        const newPosts = await submitPost(token, location, description);\r\n        // Do some stuff with the data that comes back\r\n        setPosts(newPosts);\r\n    };\r\n\r\n    const handleDeletePost = async (e, postId) => {\r\n        e.stopPropagation();\r\n        if (window.confirm(\"Are you sure?\")) {\r\n            // Call an api utility to delete this thing\r\n            const isDeleted = await deletePost(token, postId);\r\n            // update my vacations state\r\n            // Update the vacations state by removing the vacation i just deleted\r\n            if (isDeleted) {\r\n                const remainingPosts = posts.filter((vc) => vc.id != postId);\r\n                setPosts(remainingPosts);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <h1>Posts</h1>\r\n\r\n            <input\r\n                onChange={(e) => setSearch(e.target.value)}\r\n                type=\"text\"\r\n                name=\"search\"\r\n                placeholder=\"search\"\r\n            />\r\n\r\n            {user && token && (\r\n                <form onSubmit={handleSubmitPost}>\r\n                    <input\r\n                        onChange={(e) => setLocation(e.target.value)}\r\n                        type=\"text\"\r\n                        name=\"location\"\r\n                        placeholder=\"location\"\r\n                        value={location}\r\n                    />\r\n                    <input\r\n                        onChange={(e) => setDescription(e.target.value)}\r\n                        type=\"text\"\r\n                        name=\"description\"\r\n                        placeholder=\"description\"\r\n                        value={description}\r\n                    />\r\n                    <button type=\"submit\">Submit Posts</button>\r\n                </form>\r\n            )}\r\n\r\n            <section>\r\n                {posts\r\n                    .filter((post) => {\r\n                        return searchMatches(post);\r\n                    })\r\n                    .map((post) => {\r\n                        return (\r\n                            <div\r\n                                key={post.id}\r\n                                onClick={(e) => {\r\n                                    handlePostClick(e, post);\r\n                                }}\r\n                                className=\"vacation-body\"\r\n                            >\r\n                                <h3>{post.location}</h3>\r\n                                <p>{post.description}</p>\r\n\r\n                                {user && token && post.guestId == user.id && (\r\n                                    <button\r\n                                        onClick={(e) =>\r\n                                            handleDeletePost(e, post.id)\r\n                                        }\r\n                                    >\r\n                                        Delete post\r\n                                    </button>\r\n                                )}\r\n                            </div>\r\n                        );\r\n                    })}\r\n            </section>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Posts;\r\n\r\n/// fix vactions body css in line 83\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}