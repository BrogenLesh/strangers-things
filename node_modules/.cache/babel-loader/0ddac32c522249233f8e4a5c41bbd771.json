{"ast":null,"code":"import _regeneratorRuntime from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useHistory,useParams}from\"react-router-dom\";import{fetchPosts,deletePost,submitComment}from\"./utility\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var featuredPosts=function featuredPosts(_ref){var _featuredPost$guest;var user=_ref.user,token=_ref.token,posts=_ref.posts,setPosts=_ref.setPosts,featuredPost=_ref.featuredPost,setFeaturedPost=_ref.setFeaturedPost;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),newComment=_useState2[0],setNewComment=_useState2[1];var history=useHistory();var _useParams=useParams(),postId=_useParams.postId;var handleClose=function handleClose(){setFeaturedPost(false);history.push('/posts');};var handleSubmitComment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _comment,newPosts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return submitComment(token,newComment,featuredPost.id);case 3:_comment=_context.sent;_context.next=6;return fetchPosts(token);case 6:newPosts=_context.sent;setPosts(newPosts);setFeaturedPost(newPosts.find(function(pt){return pt.id==featuredPost.id;}));case 9:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmitComment(_x){return _ref2.apply(this,arguments);};}();var handleDeletePost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e,postId){var isDeleted,remainingPosts;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.stopPropagation();if(!window.confirm('Are you sure?')){_context2.next=6;break;}_context2.next=4;return deletePost(token,postId);case 4:isDeleted=_context2.sent;if(isDeleted){handleClose();remainingPosts=posts.filter(function(pt){return pt.id!=postId;});setPosts(remainingPosts);}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDeletePost(_x2,_x3){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"article\",{className:\"featured-post\",children:[/*#__PURE__*/_jsx(\"h1\",{children:featuredPost.title}),/*#__PURE__*/_jsx(\"p\",{children:featuredPost.location}),/*#__PURE__*/_jsx(\"p\",{children:featuredPost.description}),/*#__PURE__*/_jsx(\"p\",{children:featuredPost.price}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Posted by: \",featuredPost===null||featuredPost===void 0?void 0:(_featuredPost$guest=featuredPost.guest)===null||_featuredPost$guest===void 0?void 0:_featuredPost$guest.username]}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Comments\"}),/*#__PURE__*/_jsx(\"ul\",{children:featuredPost.comments.map(function(comment){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[comment.content,\" posted by: \",comment.guest.username]})},comment.id);})})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setNewComment(e.target.value);},type:\"text\",name:\"comment\",placeholder:\"comment\",value:newComment}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit Comment\"})]}),/*#__PURE__*/_jsx(\"section\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClose,children:\"Close\"}),user&&token&&featuredPost.guestId==user.id&&/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){handleDeletePost(e,featuredPost.id);},children:\"Delete \"})]});};export default featuredPosts;","map":{"version":3,"names":["React","useState","useEffect","useHistory","useParams","fetchPosts","deletePost","submitComment","featuredPosts","user","token","posts","setPosts","featuredPost","setFeaturedPost","newComment","setNewComment","history","postId","handleClose","push","handleSubmitComment","e","preventDefault","id","_comment","newPosts","find","pt","handleDeletePost","stopPropagation","window","confirm","isDeleted","remainingPosts","filter","title","location","description","price","guest","username","comments","map","comment","content","target","value","guestId"],"sources":["D:/vscode project/Course Work/strangers-things/src/components/FeaturedPost.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useHistory, useParams } from \"react-router-dom\";\r\nimport { fetchPosts, deletePost, submitComment } from \"./utility\";\r\n\r\nconst featuredPosts = ({\r\n  user,\r\n  token,\r\n  posts, setPosts,\r\n  featuredPost, setFeaturedPost\r\n}) => {\r\n\r\n  const [newComment, setNewComment] = useState('')\r\n  const history = useHistory();\r\n  const {postId} = useParams();\r\n\r\n  const handleClose = () => {\r\n    setFeaturedPost(false)\r\n\r\n    history.push('/posts');\r\n  }\r\n\r\n  const handleSubmitComment = async (e) => {\r\n    e.preventDefault();\r\n    const _comment = await submitComment(token, newComment, featuredPost.id)\r\n\r\n    const newPosts= await fetchPosts(token)\r\n    setPosts(newPosts);\r\n    setFeaturedPost(newPosts.find(pt => pt.id == featuredPost.id))\r\n  }\r\n\r\n  const handleDeletePost = async (e, postId) => {\r\n    e.stopPropagation();\r\n    if (window.confirm('Are you sure?')) {\r\n      const isDeleted = await deletePost(token, postId)\r\n      if (isDeleted) {\r\n        handleClose()\r\n        const remainingPosts = posts.filter(pt => pt.id != postId)\r\n        setPosts(remainingPosts)\r\n      }\r\n    }\r\n  }\r\n\r\n  return <article className=\"featured-post\">\r\n    <h1>{featuredPost.title}</h1>\r\n    <p>{featuredPost.location}</p>\r\n    <p>{featuredPost.description}</p>\r\n    <p>{featuredPost.price}</p>\r\n    <p>Posted by: {featuredPost?.guest?.username}</p>\r\n\r\n    <section>\r\n      <h2>Comments</h2>\r\n      <ul>\r\n        {featuredPost.comments.map(comment => {\r\n          return <li key={comment.id}>\r\n            <span>{comment.content} posted by: {comment.guest.username}</span>\r\n          </li>\r\n        })}\r\n      </ul>\r\n    </section>\r\n\r\n    <form onSubmit={handleSubmitComment}>\r\n        <input \r\n          onChange={(e) => setNewComment(e.target.value)}\r\n          type=\"text\" name=\"comment\" \r\n          placeholder=\"comment\" value={newComment} />\r\n          <button type=\"submit\">Submit Comment</button>\r\n    </form>\r\n\r\n    <section>\r\n      {/* Submit comment component */}\r\n    </section>\r\n    <button onClick={handleClose}>Close</button>\r\n    {user && token && (featuredPost.guestId == user.id) &&\r\n        <button onClick={(e) => {handleDeletePost(e, featuredPost.id)}}>Delete </button>\r\n      }\r\n  </article>\r\n}\r\n\r\n\r\nexport default featuredPosts;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}