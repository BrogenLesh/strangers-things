{"ast":null,"code":"import _regeneratorRuntime from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var STRANGER_THINGS_API_URL=\"https://strangers-things.herokuapp.com/api/2204-FTB-MT-WEB-PT/\";export var apiCall=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(url){var method,token,body,data,response,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:method=_args.length>1&&_args[1]!==undefined?_args[1]:\"GET\";token=_args.length>2?_args[2]:undefined;body=_args.length>3?_args[3]:undefined;data=false;_context.prev=4;_context.next=7;return fetch(STRANGER_THINGS_API_URL+url,setToken(getFetchOptions(method,body),token));case 7:response=_context.sent;_context.next=10;return response.json();case 10:data=_context.sent;if(!data.error){_context.next=13;break;}throw data.error;case 13:_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](4);console.error(_context.t0);case 18:return _context.abrupt(\"return\",data);case 19:case\"end\":return _context.stop();}}},_callee,null,[[4,15]]);}));return function apiCall(_x){return _ref.apply(this,arguments);};}();var getFetchOptions=function getFetchOptions(method,body){return{method:method.toUpperCase(),headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)};};var setToken=function setToken(body,token){return token?Object.assign(body,{headers:Object.assign(body.headers,{Authorization:\"Bearer \".concat(token)})}):body;};//helper functions for api use\nexport var fetchPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(token){var data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return apiCall('/posts','GET',token);case 2:data=_context2.sent;if(!(!data||!data.data)){_context2.next=5;break;}return _context2.abrupt(\"return\",[]);case 5:return _context2.abrupt(\"return\",data.data.posts||[]);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchPosts(_x2){return _ref2.apply(this,arguments);};}();export var fetchPost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(token,postId){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchPost(_x3,_x4){return _ref3.apply(this,arguments);};}();export var loginUser=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(username,password){var login;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return apiCall(\"/users/login\",\"POST\",null,{guest:{username:username,password:password}});case 2:login=_context4.sent;return _context4.abrupt(\"return\",{user:login.data.guest,token:login.data.token});case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function loginUser(_x5,_x6){return _ref4.apply(this,arguments);};}();export var registerUser=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(username,password){var registration;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return apiCall(\"/users/register\",\"POST\",null,{guest:{username:username,password:password}});case 2:registration=_context5.sent;return _context5.abrupt(\"return\",{user:registration.data.guest,token:registration.data.token});case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function registerUser(_x7,_x8){return _ref5.apply(this,arguments);};}();export var submitComment=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(token,content,postId){var data;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return apiCall(\"/posts/\".concat(postId,\"/comments\"),'POST',token,{comment:{content:content},guest:{token:token}});case 2:data=_context6.sent;console.log('comment?',data);return _context6.abrupt(\"return\",data);case 5:case\"end\":return _context6.stop();}}},_callee6);}));return function submitComment(_x9,_x10,_x11){return _ref6.apply(this,arguments);};}();export var submitPost=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(token,location,description,price,title){var data,newPosts;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return apiCall(\"/posts\",'POST',token,{post:{description:description,location:location,price:price,title:title}});case 2:data=_context7.sent;_context7.next=5;return fetchPosts(token);case 5:newPosts=_context7.sent;return _context7.abrupt(\"return\",newPosts);case 7:case\"end\":return _context7.stop();}}},_callee7);}));return function submitPost(_x12,_x13,_x14,_x15,_x16){return _ref7.apply(this,arguments);};}();export var deletePost=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(token,postId){var data;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return apiCall(\"/posts/\".concat(postId),'DELETE',token);case 2:data=_context8.sent;return _context8.abrupt(\"return\",data.success);case 4:case\"end\":return _context8.stop();}}},_callee8);}));return function deletePost(_x17,_x18){return _ref8.apply(this,arguments);};}();","map":{"version":3,"names":["STRANGER_THINGS_API_URL","apiCall","url","method","token","body","data","fetch","setToken","getFetchOptions","response","json","error","console","toUpperCase","headers","JSON","stringify","Object","assign","Authorization","fetchPosts","posts","fetchPost","postId","loginUser","username","password","guest","login","user","registerUser","registration","submitComment","content","comment","log","submitPost","location","description","price","title","post","newPosts","deletePost","success"],"sources":["D:/vscode project/Course Work/strangers-things/src/components/utility.js"],"sourcesContent":["const STRANGER_THINGS_API_URL =\r\n    \"https://strangers-things.herokuapp.com/api/2204-FTB-MT-WEB-PT/\";\r\n\r\nexport const apiCall = async (url, method = \"GET\", token, body) => {\r\n    let data = false;\r\n    try {\r\n        const response = await fetch(\r\n            STRANGER_THINGS_API_URL + url,\r\n            setToken(getFetchOptions(method, body), token)\r\n        );\r\n        data = await response.json();\r\n\r\n        if (data.error) {\r\n            throw data.error;\r\n        }\r\n    } catch (e) {\r\n        console.error(e);\r\n    }\r\n\r\n    return data;\r\n};\r\n\r\nconst getFetchOptions = (method, body) => {\r\n    return {\r\n        method: method.toUpperCase(),\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(body),\r\n    };\r\n};\r\n\r\nconst setToken = (body, token) => {\r\n    return token\r\n        ? Object.assign(body, {\r\n            headers: Object.assign(body.headers, {\r\n                Authorization: `Bearer ${token}`,\r\n            }),\r\n        })\r\n        : body;\r\n};\r\n\r\n\r\n//helper functions for api use\r\n\r\nexport const fetchPosts = async (token) => {\r\n    const data = await apiCall('/posts', 'GET', token)\r\n    if (!data || !data.data) {\r\n      return []\r\n    }\r\n  \r\n    return data.data.posts || [];\r\n  }\r\n  \r\n  export const fetchPost = async(token, postId) => {\r\n  \r\n  }\r\n  \r\n  export const loginUser = async(username, password) => {\r\n    const login = await apiCall(\"/users/login\", \"POST\", null, {\r\n      guest: {username, password}\r\n    })\r\n  \r\n    return {\r\n      user: login.data.guest, \r\n      token: login.data.token\r\n    };\r\n  }\r\n  \r\n  export const registerUser = async(username, password) => {\r\n    const registration = await apiCall(\"/users/register\", \"POST\", null, {\r\n      guest: {username, password}\r\n    })\r\n  \r\n    return {\r\n      user: registration.data.guest, \r\n      token: registration.data.token\r\n    };\r\n  }\r\n  \r\n  export const submitComment = async(token, content, postId) => {\r\n    const data = await apiCall(\r\n      `/posts/${postId}/comments`, \r\n      'POST', \r\n      token, \r\n      {comment: {content}, guest: {token}}\r\n    )\r\n  \r\n    console.log('comment?', data);\r\n  \r\n    return data;\r\n  }\r\n  \r\n  export const submitPost = async(token, location, description, price, title) => {\r\n    const data = await apiCall(\r\n      `/posts`, \r\n      'POST', \r\n      token, \r\n      { post: {description, location, price, title} }\r\n    )\r\n  \r\n    // Response from the API is incomplete, so let's grab the full vacation object\r\n    const newPosts = await fetchPosts(token)\r\n    return newPosts;\r\n  }\r\n  \r\n  \r\n  \r\n  export const deletePost = async(token, postId) => {\r\n    const data = await apiCall(\r\n      `/posts/${postId}`,\r\n      'DELETE',\r\n      token\r\n    );\r\n  \r\n    return data.success;\r\n  }"],"mappings":"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"},"metadata":{},"sourceType":"module"}