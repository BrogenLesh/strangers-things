{"ast":null,"code":"import _regeneratorRuntime from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/vscode project/Course Work/strangers-things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useHistory,useParams}from\"react-router-dom\";import{fetchPosts,deletePost,submitComment}from\"./utility\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var featuredPosts=function featuredPosts(_ref){var _featuredPost$guest;var user=_ref.user,token=_ref.token,posts=_ref.posts,setPosts=_ref.setPosts,featuredPost=_ref.featuredPost,setFeaturedPost=_ref.setFeaturedPost;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),newComment=_useState2[0],setNewComment=_useState2[1];var history=useHistory();var _useParams=useParams(),postId=_useParams.postId;var handleClose=function handleClose(){// clear the state\nsetFeaturedPost(false);// go back to vacations\nhistory.push('/posts');};var handleSubmitComment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _comment,newPosts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();// submit the comment to the server, using our API thingy\n_context.next=3;return submitComment(token,newComment,featuredPost.id);case 3:_comment=_context.sent;_context.next=6;return fetchPosts(token);case 6:newPosts=_context.sent;setPosts(newPosts);setFeaturedPost(newPosts.find(function(pt){return pt.id==featuredPost.id;}));case 9:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmitComment(_x){return _ref2.apply(this,arguments);};}();var handleDeletePost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e,postId){var isDeleted,remainingPosts;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.stopPropagation();if(!window.confirm('Are you sure?')){_context2.next=6;break;}_context2.next=4;return deletePost(token,postId);case 4:isDeleted=_context2.sent;// update my vacations state\n// Update the vacations state by removing the vacation i just deleted\nif(isDeleted){handleClose();remainingPosts=posts.filter(function(pt){return pt.id!=postId;});setPosts(remainingPosts);}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDeletePost(_x2,_x3){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"article\",{className:\"featured-vacation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:featuredPost.location}),/*#__PURE__*/_jsx(\"p\",{children:featuredPost.description}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Posted by: \",featuredPost===null||featuredPost===void 0?void 0:(_featuredPost$guest=featuredPost.guest)===null||_featuredPost$guest===void 0?void 0:_featuredPost$guest.username]}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Comments\"}),/*#__PURE__*/_jsx(\"ul\",{children:featuredPost.comments.map(function(comment){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[comment.content,\" posted by: \",comment.guest.username]})},comment.id);})})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setNewComment(e.target.value);},type:\"text\",name:\"comment\",placeholder:\"comment\",value:newComment}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit Comment\"})]}),/*#__PURE__*/_jsx(\"section\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClose,children:\"Close\"}),user&&token&&featuredPost.guestId==user.id&&/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){handleDeletePost(e,featuredPost.id);},children:\"Delete post\"})]});};export default featuredPosts;","map":{"version":3,"names":["React","useState","useEffect","useHistory","useParams","fetchPosts","deletePost","submitComment","featuredPosts","user","token","posts","setPosts","featuredPost","setFeaturedPost","newComment","setNewComment","history","postId","handleClose","push","handleSubmitComment","e","preventDefault","id","_comment","newPosts","find","pt","handleDeletePost","stopPropagation","window","confirm","isDeleted","remainingPosts","filter","location","description","guest","username","comments","map","comment","content","target","value","guestId"],"sources":["D:/vscode project/Course Work/strangers-things/src/components/featuredPosts.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useHistory, useParams } from \"react-router-dom\";\r\nimport { fetchPosts, deletePost, submitComment } from \"./utility\";\r\n\r\nconst featuredPosts = ({\r\n  user,\r\n  token,\r\n  posts, setPosts,\r\n  featuredPost, setFeaturedPost\r\n}) => {\r\n\r\n  const [newComment, setNewComment] = useState('')\r\n  const history = useHistory();\r\n  const {postId} = useParams();\r\n\r\n  const handleClose = () => {\r\n    // clear the state\r\n    setFeaturedPost(false)\r\n\r\n    // go back to vacations\r\n    history.push('/posts');\r\n  }\r\n\r\n  const handleSubmitComment = async (e) => {\r\n    e.preventDefault();\r\n    // submit the comment to the server, using our API thingy\r\n    const _comment = await submitComment(token, newComment, featuredPost.id)\r\n\r\n    const newPosts= await fetchPosts(token)\r\n    setPosts(newPosts);\r\n    setFeaturedPost(newPosts.find(pt => pt.id == featuredPost.id))\r\n  }\r\n\r\n  const handleDeletePost = async (e, postId) => {\r\n    e.stopPropagation();\r\n    if (window.confirm('Are you sure?')) {\r\n      // Call an api utility to delete this thing\r\n      const isDeleted = await deletePost(token, postId)\r\n      // update my vacations state\r\n      // Update the vacations state by removing the vacation i just deleted\r\n      if (isDeleted) {\r\n        handleClose()\r\n        const remainingPosts = posts.filter(pt => pt.id != postId)\r\n        setPosts(remainingPosts)\r\n      }\r\n    }\r\n  }\r\n\r\n  return <article className=\"featured-vacation\">\r\n    <h1>{featuredPost.location}</h1>\r\n    <p>{featuredPost.description}</p>\r\n    <p>Posted by: {featuredPost?.guest?.username}</p>\r\n\r\n    <section>\r\n      <h2>Comments</h2>\r\n      <ul>\r\n        {featuredPost.comments.map(comment => {\r\n          return <li key={comment.id}>\r\n            <span>{comment.content} posted by: {comment.guest.username}</span>\r\n          </li>\r\n        })}\r\n      </ul>\r\n    </section>\r\n\r\n    <form onSubmit={handleSubmitComment}>\r\n        <input \r\n          onChange={(e) => setNewComment(e.target.value)}\r\n          type=\"text\" name=\"comment\" \r\n          placeholder=\"comment\" value={newComment} />\r\n          <button type=\"submit\">Submit Comment</button>\r\n    </form>\r\n\r\n    <section>\r\n      {/* Submit comment component */}\r\n    </section>\r\n    <button onClick={handleClose}>Close</button>\r\n    {user && token && (featuredPost.guestId == user.id) &&\r\n        <button onClick={(e) => {handleDeletePost(e, featuredPost.id)}}>Delete post</button>\r\n      }\r\n  </article>\r\n}\r\n\r\n\r\nexport default featuredPosts;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}