{"ast":null,"code":"const STRANGER_THINGS_API_URL = \"https://strangers-things.herokuapp.com/api/2204-FTB-MT-WEB-PT/\";\nexport const apiCall = async function (url) {\n  let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"GET\";\n  let token = arguments.length > 2 ? arguments[2] : undefined;\n  let body = arguments.length > 3 ? arguments[3] : undefined;\n  let data = false;\n\n  try {\n    const response = await fetch(STRANGER_THINGS_API_URL + url, setToken(getFetchOptions(method, body), token));\n    data = await response.json();\n\n    if (data.error) {\n      throw data.error;\n    }\n  } catch (e) {\n    console.error(e);\n  }\n\n  return data;\n};\n\nconst getFetchOptions = (method, body) => {\n  return {\n    method: method.toUpperCase(),\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(body)\n  };\n};\n\nconst setToken = (body, token) => {\n  console.log(body, token);\n  return token ? Object.assign(body, {\n    headers: Object.assign(body.headers, {\n      Authorization: `Bearer ${token}`\n    })\n  }) : body;\n}; //helper functions for api use\n\n\nexport const fetchPosts = async token => {\n  const data = await apiCall('/posts', 'GET', token);\n\n  if (!data || !data.data) {\n    return [];\n  }\n\n  return data.data.posts || [];\n};\nexport const loginUser = async (username, password) => {\n  const login = await apiCall(\"users/login\", \"POST\", null, {\n    user: {\n      username,\n      password\n    }\n  });\n  const grabToken = await apiCall('users/me', 'GET', login.data.token);\n  console.log(grabToken.data);\n  return {\n    user: grabToken.data,\n    token: login.data.token\n  };\n};\nexport const registerUser = async (username, password) => {\n  console.log(username, password);\n  const registration = await apiCall(\"users/register\", \"POST\", null, {\n    user: {\n      username,\n      password\n    }\n  });\n  return {\n    user: registration.data.user,\n    token: registration.data.token\n  };\n};","map":{"version":3,"names":["STRANGER_THINGS_API_URL","apiCall","url","method","token","body","data","response","fetch","setToken","getFetchOptions","json","error","e","console","toUpperCase","headers","JSON","stringify","log","Object","assign","Authorization","fetchPosts","posts","loginUser","username","password","login","user","grabToken","registerUser","registration"],"sources":["/home/leshb/Course Work/strangers-things/src/components/utility.js"],"sourcesContent":["const STRANGER_THINGS_API_URL =\r\n    \"https://strangers-things.herokuapp.com/api/2204-FTB-MT-WEB-PT/\";\r\n\r\nexport const apiCall = async (url, method = \"GET\", token, body) => {\r\n    let data = false;\r\n    try {\r\n        const response = await fetch(\r\n            STRANGER_THINGS_API_URL + url,\r\n            setToken(getFetchOptions(method, body), token)\r\n        );\r\n        data = await response.json();\r\n        if (data.error) {\r\n            throw data.error;\r\n        }\r\n    } catch (e) {\r\n        console.error(e);\r\n    }\r\n\r\n    return data;\r\n};\r\n\r\nconst getFetchOptions = (method, body) => {\r\n    return {\r\n        method: method.toUpperCase(),\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(body),\r\n    };\r\n};\r\n\r\nconst setToken = (body, token) => {\r\n  console.log(body,token)\r\n    return token\r\n        ? Object.assign(body, {\r\n            headers: Object.assign(body.headers, {\r\n                Authorization: `Bearer ${token}`,\r\n            }),\r\n        })\r\n        : body;\r\n};\r\n\r\n\r\n//helper functions for api use\r\n\r\nexport const fetchPosts = async (token) => {\r\n    const data = await apiCall('/posts', 'GET', token)\r\n    if (!data || !data.data) {\r\n      return []\r\n    }\r\n  \r\n    return data.data.posts || [];\r\n  }\r\n  \r\n\r\n  \r\n  export const loginUser = async(username, password) => {\r\n    const login = await apiCall(\"users/login\", \"POST\", null, {\r\n      user: {username, password}\r\n    })\r\n  const grabToken = await apiCall('users/me', 'GET', login.data.token)\r\n  console.log(grabToken.data)\r\n    return {\r\n      user: grabToken.data, \r\n      token: login.data.token\r\n    };\r\n  }\r\n  \r\n  export const registerUser = async(username, password) => {\r\n    console.log(username,password)\r\n    const registration = await apiCall(\"users/register\", \"POST\", null, {\r\n      user: {username, password}\r\n    })\r\n  \r\n    return {\r\n      user: registration.data.user, \r\n      token: registration.data.token\r\n    };\r\n  }\r\n  \r\n\r\n  \r\n\r\n  \r\n  \r\n  \r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}