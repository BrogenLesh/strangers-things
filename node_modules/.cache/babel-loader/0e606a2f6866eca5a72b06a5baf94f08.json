{"ast":null,"code":"const STRANGER_THINGS_API_URL = \"https://strangers-things.herokuapp.com/api/2204-FTB-MT-WEB-PT/\";\nexport const apiCall = async function (url) {\n  let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"GET\";\n  let token = arguments.length > 2 ? arguments[2] : undefined;\n  let body = arguments.length > 3 ? arguments[3] : undefined;\n  let data = false;\n\n  try {\n    const response = await fetch(STRANGER_THINGS_API_URL + url, setToken(getFetchOptions(method, body), token));\n    data = await response.json();\n\n    if (data.error) {\n      throw data.error;\n    }\n  } catch (e) {\n    console.error(e);\n  }\n\n  return data;\n};\n\nconst getFetchOptions = (method, body) => {\n  return {\n    method: method.toUpperCase(),\n    body: JSON.stringify(body)\n  };\n};\n\nconst setToken = (body, token) => {\n  return token ? Object.assign(body, {\n    headers: Object.assign(body.headers, {\n      Authorization: `Bearer ${token}`\n    })\n  }) : body;\n}; //helper functions for api use\n\n\nexport const fetchPosts = async token => {\n  const data = await apiCall('/posts', 'GET', token);\n\n  if (!data || !data.data) {\n    return [];\n  }\n\n  return data.data.posts || [];\n};\nexport const loginUser = async (username, password) => {\n  const login = await apiCall(\"/users/login\", \"POST\", null, {\n    guest: {\n      username,\n      password\n    }\n  });\n  return {\n    user: login.data.guest,\n    token: login.data.token\n  };\n};\nexport const registerUser = async (username, password) => {\n  const registration = await apiCall(\"/users/register\", \"POST\", null, {\n    guest: {\n      username,\n      password\n    }\n  });\n  return {\n    user: registration.data.guest,\n    token: registration.data.token\n  };\n};\nexport const submitComment = async (token, content, postId) => {\n  const data = await apiCall(`/posts/${postId}/comments`, 'POST', token, {\n    comment: {\n      content\n    },\n    guest: {\n      token\n    }\n  });\n  console.log('comment?', data);\n  return data;\n};\nexport const submitPost = async (token, location, description, price, title) => {\n  const data = await apiCall(`/posts`, 'POST', token, {\n    post: {\n      description,\n      location,\n      price,\n      title\n    }\n  });\n  const newPosts = await fetchPosts(token);\n  return newPosts;\n};\nexport const deletePost = async (token, postId) => {\n  const data = await apiCall(`/posts/${postId}`, 'DELETE', token);\n  return data.success;\n};","map":{"version":3,"names":["STRANGER_THINGS_API_URL","apiCall","url","method","token","body","data","response","fetch","setToken","getFetchOptions","json","error","e","console","toUpperCase","JSON","stringify","Object","assign","headers","Authorization","fetchPosts","posts","loginUser","username","password","login","guest","user","registerUser","registration","submitComment","content","postId","comment","log","submitPost","location","description","price","title","post","newPosts","deletePost","success"],"sources":["D:/vscode project/Course Work/strangers-things/src/components/utility.js"],"sourcesContent":["const STRANGER_THINGS_API_URL =\r\n    \"https://strangers-things.herokuapp.com/api/2204-FTB-MT-WEB-PT/\";\r\n\r\nexport const apiCall = async (url, method = \"GET\", token, body) => {\r\n    let data = false;\r\n    try {\r\n        const response = await fetch(\r\n            STRANGER_THINGS_API_URL + url,\r\n            setToken(getFetchOptions(method, body), token)\r\n        );\r\n        data = await response.json();\r\n\r\n        if (data.error) {\r\n            throw data.error;\r\n        }\r\n    } catch (e) {\r\n        console.error(e);\r\n    }\r\n\r\n    return data;\r\n};\r\n\r\nconst getFetchOptions = (method, body) => {\r\n    return {\r\n        method: method.toUpperCase(),\r\n        body: JSON.stringify(body),\r\n    };\r\n};\r\n\r\nconst setToken = (body, token) => {\r\n    return token\r\n        ? Object.assign(body, {\r\n            headers: Object.assign(body.headers, {\r\n                Authorization: `Bearer ${token}`,\r\n            }),\r\n        })\r\n        : body;\r\n};\r\n\r\n\r\n//helper functions for api use\r\n\r\nexport const fetchPosts = async (token) => {\r\n    const data = await apiCall('/posts', 'GET', token)\r\n    if (!data || !data.data) {\r\n      return []\r\n    }\r\n  \r\n    return data.data.posts || [];\r\n  }\r\n  \r\n\r\n  \r\n  export const loginUser = async(username, password) => {\r\n    const login = await apiCall(\"/users/login\", \"POST\", null, {\r\n      guest: {username, password}\r\n    })\r\n  \r\n    return {\r\n      user: login.data.guest, \r\n      token: login.data.token\r\n    };\r\n  }\r\n  \r\n  export const registerUser = async(username, password) => {\r\n    const registration = await apiCall(\"/users/register\", \"POST\", null, {\r\n      guest: {username, password}\r\n    })\r\n  \r\n    return {\r\n      user: registration.data.guest, \r\n      token: registration.data.token\r\n    };\r\n  }\r\n  \r\n  export const submitComment = async(token, content, postId) => {\r\n    const data = await apiCall(\r\n      `/posts/${postId}/comments`, \r\n      'POST', \r\n      token, \r\n      {comment: {content}, guest: {token}}\r\n    )\r\n  \r\n    console.log('comment?', data);\r\n  \r\n    return data;\r\n  }\r\n  \r\n  export const submitPost = async(token, location, description, price, title) => {\r\n    const data = await apiCall(\r\n      `/posts`, \r\n      'POST', \r\n      token, \r\n      { post: {description, location, price, title} }\r\n    )\r\n    const newPosts = await fetchPosts(token)\r\n    return newPosts;\r\n  }\r\n  \r\n  \r\n  \r\n  export const deletePost = async(token, postId) => {\r\n    const data = await apiCall(\r\n      `/posts/${postId}`,\r\n      'DELETE',\r\n      token\r\n    );\r\n  \r\n    return data.success;\r\n  }"],"mappings":"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"},"metadata":{},"sourceType":"module"}